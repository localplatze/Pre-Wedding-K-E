<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <link rel="icon" type="image/png" href="icon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>#SaveTheDate 16/8/25</title>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #3D7600;
            --secondary-color: #F4CB7B;
            --accent-color: #D4A76A;
            --text-color: #333;
            --light-bg: #FFF9F0;
            --light-green-bg: #e8f0e1; /* Cor suave para hover do bot√£o */
        }

        body {
            margin: 0;
            font-family: 'Montserrat', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: url('bg.jpeg') center/cover no-repeat fixed;
            color: var(--text-color);
            overflow-x: hidden; /* Evita scroll horizontal */
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            z-index: 1;
        }

        .tv-save {
            width: 299px;
            height: auto;
            margin-bottom: 24px;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.2));
        }

        .iv-card {
            width: 260px;
            height: 260px;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            z-index: 2;
            filter: drop-shadow(0 8px 16px rgba(0,0,0,0.3));
        }

        .iv-card:hover {
            transform: translateY(-5px) scale(1.03);
            filter: drop-shadow(0 12px 24px rgba(0,0,0,0.4));
        }

        /* Removido: iv-leaves (n√£o parece ser usado ativamente) */

        .tv-subtitle {
            width: 313px;
            height: auto;
            margin-top: 24px;
            filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 48px 24px;
            box-sizing: border-box;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .modal.show {
            opacity: 1;
        }

        .modal-content {
            background: var(--light-bg);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            border: 12px double var(--secondary-color);
            border-radius: 16px;
            margin: 0 auto;
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        .modal-content.show {
            transform: scale(1);
            opacity: 1;
        }

        .modal-inner {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 64px 24px 48px 24px;
            position: relative;
        }

        .title {
            color: var(--primary-color);
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            font-size: 28px;
            margin-bottom: 16px;
            text-align: center;
            line-height: 1.3;
        }

        .subtitle {
            color: var(--text-color);
            font-size: 18px;
            margin: 16px 0;
            font-weight: 400;
        }

        .guest-name {
            color: var(--primary-color);
            font-family: 'Playfair Display', serif;
            font-weight: 700;
            font-size: 32px;
            margin: 16px 0;
            line-height: 1.2;
        }

        .date-image {
            width: 277px;
            height: auto;
            margin: 32px 0;
            filter: drop-shadow(0 4px 8px rgba(0,0,0,0.1));
        }

        .confirm-title {
            width: 214px;
            height: auto;
            margin: 24px 0;
        }

        .confirm-text {
            font-size: 16px;
            color: var(--text-color);
            margin: 16px 24px;
            line-height: 1.6;
            max-width: 80%;
        }

        .buttons-container {
            display: flex;
            justify-content: center;
            margin-top: 24px;
            gap: 24px;
            padding: 0 24px;
            flex-wrap: wrap;
        }

        .button-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
            min-width: 120px;
        }

        /* --- Estilo de Bot√£o Atualizado --- */
        .circular-button {
            width: 70px; /* Tamanho ligeiramente reduzido */
            height: 70px;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            background: white; /* Fundo branco base */
            border: 1px solid #eee; /* Borda bem sutil */
            margin-bottom: 12px;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
            color: var(--primary-color); /* Define a cor para o SVG usar */
        }

        .circular-button svg {
            width: 32px; /* Tamanho do √≠cone SVG */
            height: 32px;
            transition: transform 0.3s ease; /* Anima√ß√£o de escala no hover */
        }

        .circular-button:hover {
            background-color: var(--light-green-bg); /* Fundo verde claro suave no hover */
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .circular-button:hover svg {
            transform: scale(1.1); /* Aumenta ligeiramente o √≠cone no hover */
        }
        /* --- Fim do Estilo de Bot√£o Atualizado --- */

        .button-text {
            font-size: 14px;
            color: var(--text-color);
            text-align: center;
            margin-top: 0; /* Ajustado */
            font-weight: 500;
        }

        .leaf1, .leaf2 {
            position: absolute;
            width: 180px;
            height: auto;
            pointer-events: none;
            z-index: -1;
            opacity: 0.8;
        }

        .leaf1 {
            top: -40px;
            left: -40px;
            transform: rotate(-15deg);
            animation: float 6s ease-in-out infinite;
        }

        .leaf2 {
            bottom: -40px;
            right: -40px;
            transform: rotate(15deg);
            animation: float 8s ease-in-out infinite 1s;
        }

        /* --- Envelope Animation Atualizada --- */
        .envelope-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 999;
            background: rgba(0, 0, 0, 0.7);
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .envelope-animation.show {
            opacity: 1;
        }

        .envelope-container {
            position: relative; /* Mudado para relative para posicionar flap e base */
            width: 260px;
            height: 260px;
            perspective: 1000px;
            /* position: absolute; ser√° definido via JS */
        }

        .envelope-base { /* Estilo para a parte de tr√°s/fixa */
            width: 100%;
            height: 100%;
            position: absolute;
            top: 0;
            left: 0;
            filter: drop-shadow(0 8px 16px rgba(0,0,0,0.3));
        }

        .envelope-flap { /* Estilo para a aba/flap que anima */
            width: 100%; /* Ajuste conforme a imagem da aba */
            height: auto; /* Ajuste conforme a imagem da aba */
            position: absolute;
            top: 0; /* Posiciona no topo */
            left: 0;
            opacity: 0;
            transform-style: preserve-3d;
            transition: all 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            transform-origin: top center; /* Gira a partir da borda superior central */
            filter: drop-shadow(0 8px 16px rgba(0,0,0,0.3));
            z-index: 10; /* Garante que fique sobre a base */
        }

        .envelope-flap.show {
            opacity: 1;
            /* CORRE√á√ÉO: Gira para cima (negativo) */
            transform: rotateX(-150deg) translateY(0px); /* Ajuste o √¢ngulo e Y conforme necess√°rio */
        }

        .letter {
            position: absolute;
            background: white;
            /* Posi√ß√£o inicial DENTRO do envelope visualmente */
            top: 25%; /* Ajuste para parecer que est√° saindo */
            left: 50%;
            transform: translate(-50%, 0) scale(0.8); /* Come√ßa um pouco menor */
            width: 200px;
            height: 10px; /* Come√ßa fino */
            opacity: 0;
            border-radius: 4px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transform-origin: center;
            z-index: 5; /* Abaixo da flap, acima da base */
        }

        .letter.animate {
            animation: expandLetter 1.2s cubic-bezier(0.175, 0.885, 0.32, 1.275) forwards;
            animation-delay: 0.3s; /* Pequeno delay para a aba levantar primeiro */
        }

        @keyframes expandLetter {
            0% {
                width: 200px;
                height: 10px;
                top: 25%;
                left: 50%;
                transform: translate(-50%, 0) scale(0.8);
                opacity: 1;
            }
            30% { /* Sobe e come√ßa a crescer */
                width: 220px;
                height: 180px;
                top: 10%;
                left: 50%;
                transform: translate(-50%, 0) scale(1);
                opacity: 1;
                box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            }
            100% { /* Expande para o tamanho final do modal */
                width: 90vw;
                max-width: 600px;
                height: 90vh;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
                box-shadow: 0 20px 50px rgba(0,0,0,0.3);
                border-radius: 16px; /* Mesma borda do modal */
            }
        }
        /* --- Fim da Anima√ß√£o do Envelope --- */


        @keyframes float {
            0%, 100% { transform: translateY(0) rotate(-15deg); }
            50% { transform: translateY(-20px) rotate(-15deg); }
        }

        /* --- Film Roll Animation --- */
        .film-roll-container {
            position: fixed;
            bottom: 70px; /* Posi√ß√£o acima do player de m√∫sica */
            left: 0;
            width: 100%;
            height: 120px; /* Altura do rolo de filme */
            overflow: hidden;
            z-index: 800; /* Abaixo do modal e envelope */
            pointer-events: none; /* N√£o interfere com cliques */
            background: rgba(0, 0, 0, 0.1); /* Fundo sutil opcional */
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
            display: flex; /* Para alinhar o track */
            align-items: center; /* Centraliza as fotos verticalmente */
        }

        .film-roll-track {
            display: flex; /* Coloca as fotos lado a lado */
            height: 100px; /* Altura das fotos + padding */
            /* A largura ser√° definida dinamicamente ou ser√° muito grande */
            /* A anima√ß√£o far√° a rolagem */
            animation: scrollFilm 40s linear infinite; /* Ajuste a dura√ß√£o (40s) conforme necess√°rio */
            will-change: transform; /* Otimiza√ß√£o para anima√ß√£o */
        }

        .film-photo {
            flex-shrink: 0; /* Impede que as fotos encolham */
            width: 100px; /* Largura de cada foto */
            height: 100px;
            margin: 0 10px; /* Espa√ßamento entre fotos */
            background: white;
            padding: 5px; /* Borda branca tipo polaroid */
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden; /* Garante que a imagem n√£o vaze */
        }

        .film-photo img {
            display: block;
            max-width: 100%;
            max-height: 100%;
            object-fit: cover; /* Cobre a √°rea sem distorcer */
        }

        @keyframes scrollFilm {
            0% {
                transform: translateX(0);
            }
            100% {
                /* Move para a esquerda pela largura de um conjunto de fotos */
                /* O valor exato ser√° definido pelo JS, mas aqui usamos um valor grande */
                /* Se temos N fotos, e cada uma com margem tem W de largura, movemos -N*W */
                transform: translateX(-50%); /* Move metade da largura total do track (que cont√©m 2x as fotos) */
            }
        }
        /* --- Fim do Film Roll --- */


        /* Thank You Image (mantido como estava) */
        .thank-you-image {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 80%;
            max-height: 80vh;
            z-index: 1200;
            opacity: 0;
            transition: all 0.8s ease;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            border: 10px solid white;
            border-radius: 8px;
            pointer-events: none; /* Para n√£o bloquear cliques ap√≥s desaparecer */
        }

        .thank-you-image.show {
            opacity: 1;
        }

        /* Guests Dialog (mantido como estava) */
        .guests-dialog {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        .guests-dialog.show { opacity: 1; }
        .guests-dialog-content {
            background: white;
            border-radius: 12px;
            padding: 24px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
            transform: scale(0.9);
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }
        .guests-dialog-content.show { transform: scale(1); opacity: 1; }
        .guest-item { display: flex; justify-content: space-between; align-items: center; padding: 12px 0; border-bottom: 1px solid #eee; }
        .guest-name-label { font-size: 16px; color: #333; }
        .guest-buttons { display: flex; gap: 8px; }
        .response-button { padding: 8px 16px; border: 2px solid var(--primary-color); border-radius: 6px; background: white; color: var(--primary-color); cursor: pointer; transition: all 0.3s ease; font-weight: 500; }
        .response-button:hover { background: var(--primary-color); color: white; }
        .response-button.selected { background: var(--primary-color); color: white; }
        .dialog-actions { display: flex; justify-content: space-between; margin-top: 24px; gap: 12px; }
        .confirm-all-button, .back-button { padding: 12px 24px; border: none; border-radius: 6px; cursor: pointer; flex: 1; font-weight: 600; transition: all 0.3s ease; }
        .confirm-all-button { background: var(--primary-color); color: white; }
        .confirm-all-button:hover { background: #2B5400; transform: translateY(-2px); }
        .back-button { background: #FF4444; color: white; }
        .back-button:hover { background: #CC0000; transform: translateY(-2px); }

        /* Thank You Modal (mantido como estava) */
        .thank-you-modal { text-align: center; padding: 48px 24px; animation: fadeIn 0.8s ease; }
        .thank-you-title { color: var(--primary-color); font-size: 28px; font-weight: bold; margin-bottom: 24px; font-family: 'Playfair Display', serif; }
        .thank-you-message { color: var(--text-color); font-size: 18px; line-height: 1.6; max-width: 400px; margin: 0 auto 32px; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Music Player */
        .music-player {
            position: fixed;
            bottom: 20px;
            right: 20px;
            width: 50px;
            height: 50px;
            background: rgba(255,255,255,0.8);
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            z-index: 1100; /* Acima do rolo de filme */
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
            color: var(--primary-color); /* Cor para os √≠cones SVG */
        }

        .music-player:hover {
            transform: scale(1.1);
            background: white;
        }

        .music-icon {
            width: 24px;
            height: 24px;
        }

        /* Responsive Adjustments */
        @media (max-width: 768px) {
            .modal { padding: 24px 12px; }
            .buttons-container { flex-direction: column; gap: 24px; }
            .modal-content { border-radius: 12px; }
            .leaf1, .leaf2 { width: 120px; }
            .title { font-size: 24px; }
            .guest-name { font-size: 28px; }
            .date-image { width: 220px; }
            .film-roll-container { height: 100px; bottom: 80px; } /* Ajuste responsivo */
            .film-roll-track { height: 80px; }
            .film-photo { width: 80px; height: 80px; margin: 0 5px;}
            .circular-button { width: 60px; height: 60px; }
            .circular-button svg { width: 28px; height: 28px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <img class="tv-save" src="tv_save_the_date.png" alt="Save the Date">
        <img class="iv-card" src="iv_card.png" alt="Card" onclick="startAnimation()">
        <img class="tv-subtitle" src="tv_subtitle.png" alt="Subtitle">
    </div>

    <!-- Envelope Animation -->
    <div class="envelope-animation" id="envelopeAnimation">
        <div class="envelope-container">
            <!-- Imagem do envelope (pode ser a parte de tr√°s ou uma base) -->
            <img class="envelope-base" src="envelope_base.png" alt="Base do Envelope">
            <!-- Imagem da aba/flap que vai animar -->
            <img class="envelope-flap" id="envelopeFlap" src="envelope_flap.png" alt="Aba do Envelope">
            <div class="letter" id="letter"></div>
        </div>
    </div>

    <!-- Film Roll Photo Animation -->
    <div class="film-roll-container" id="filmRollContainer">
        <div class="film-roll-track" id="filmRollTrack">
            <!-- Fotos ser√£o adicionadas aqui pelo JavaScript -->
        </div>
    </div>

    <!-- Thank You Image (opcional, se quiser manter) -->
    <img class="thank-you-image" id="thankYouImage" src="" alt="Thank You">

    <!-- Modal -->
    <div class="modal" id="inviteModal">
        <div class="modal-content">
            <img class="leaf1" src="iv_leaf1.png" alt="Leaf 1">
            <img class="leaf2" src="iv_leaf2.png" alt="Leaf 2">

            <div class="modal-inner">
                <h1 class="title">Elian e Keytiane<br>est√£o se casando!</h1>
                <p class="subtitle">E queremos que voc√™</p>
                <p class="guest-name">Nome Convidado</p>
                <p class="subtitle">fa√ßa parte dessa celebra√ß√£o</p>

                <img class="date-image" src="iv_date.png" alt="Data">
                <img class="confirm-title" src="tv_confirm_title.png" alt="Confirme sua presen√ßa">

                <p class="confirm-text">
                    Por favor, nos informe abaixo se voc√™ poder√° se juntar a n√≥s nesse dia especial.
                </p>

                <div class="buttons-container">
                    <div class="button-group">
                        <button class="circular-button" data-response="Sim">
                            <!-- √çcone SVG para SIM -->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="36px" height="36px">
                              <path fill-rule="evenodd" d="M19.916 4.626a.75.75 0 0 1 .208 1.04l-9 13.5a.75.75 0 0 1-1.154.114l-6-6a.75.75 0 0 1 1.06-1.06l5.353 5.353 8.454-12.68a.75.75 0 0 1 1.04-.208Z" clip-rule="evenodd" />
                            </svg>
                        </button>
                        <span class="button-text">Sim, eu posso comparecer!</span>
                    </div>

                    <div class="button-group">
                         <button class="circular-button" data-response="Talvez">
                            <!-- √çcone SVG para TALVEZ -->
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100">
                                <circle cx="50" cy="50" r="45" fill="#3D7600" opacity="0.2" />
                                    <path d="M50 20C40 20 32 28 32 38h12c0-4 2-6 6-6s6 2 6 6c0 4-2 6-6 8-4 2-6 6-6 10v4h12v-2c0-4 2-6 6-8 4-2 8-6 8-12 0-10-8-18-20-18Z" fill="#3D7600" />
                                <circle cx="50" cy="75" r="6" fill="#3D7600" />
                            </svg>
                        </button>
                        <span class="button-text">Preciso de um tempo para confirmar</span>
                    </div>

                    <div class="button-group">
                        <button class="circular-button" data-response="N√£o">
                           <!-- √çcone SVG para N√ÉO -->
                           <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="36px" height="36px">
                             <path fill-rule="evenodd" d="M5.47 5.47a.75.75 0 0 1 1.06 0L12 10.94l5.47-5.47a.75.75 0 1 1 1.06 1.06L13.06 12l5.47 5.47a.75.75 0 1 1-1.06 1.06L12 13.06l-5.47 5.47a.75.75 0 0 1-1.06-1.06L10.94 12 5.47 6.53a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd" />
                           </svg>
                        </button>
                        <span class="button-text">Infelizmente n√£o posso comparecer</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Guests Dialog -->
    <div class="guests-dialog" id="guestsDialog">
        <div class="guests-dialog-content">
            <h2>Confirme a presen√ßa</h2>
            <div id="guestsList">
                <!-- Preenchido dinamicamente -->
            </div>
            <div class="dialog-actions">
                <button class="confirm-all-button" onclick="confirmAllResponses()">
                    Confirmar Op√ß√£o para Todos
                </button>
                <button class="back-button" onclick="closeGuestsDialog()">
                    Voltar
                </button>
            </div>
        </div>
    </div>

    <!-- Music Player -->
    <div class="music-player" id="musicPlayer" onclick="toggleMusic()">
        <!-- √çcone Play SVG -->
        <svg class="music-icon" id="playIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px">
          <path fill-rule="evenodd" d="M4.5 5.653c0-1.427 1.529-2.33 2.779-1.643l11.54 6.347c1.295.712 1.295 2.573 0 3.286L7.28 19.99c-1.25.687-2.779-.217-2.779-1.643V5.653Z" clip-rule="evenodd" />
        </svg>
        <!-- √çcone Pause SVG (inicialmente escondido) -->
        <svg class="music-icon" id="pauseIcon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24px" height="24px" style="display: none;">
          <path fill-rule="evenodd" d="M6.75 5.25a.75.75 0 0 1 .75-.75H9a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75H7.5a.75.75 0 0 1-.75-.75V5.25Zm7.5 0a.75.75 0 0 1 .75-.75h1.5a.75.75 0 0 1 .75.75v13.5a.75.75 0 0 1-.75.75h-1.5a.75.75 0 0 1-.75-.75V5.25Z" clip-rule="evenodd" />
        </svg>
    </div>

    <audio id="backgroundMusic" loop>
        <source src="song.mp3" type="audio/mpeg">
    </audio>

    <script>
        const TELEGRAM_BOT_TOKEN = '7790968479:AAFWGQcuxa2sy95191i0IjNAFAZNDspDLXI';
        const TELEGRAM_CHANNEL_ID = '-1002378516159';

        // Dados dos convidados (mantido)
        const uuidGuests = {
            '3432420a-d313-499c-97e7-a7c8c8030bba': ['Keytiane Ferreira'],
            '4fff8a0f-db03-4be5-aa83-f94d2cc0d157': ['Paul McCartney'],
            '25f8cd16-ba08-4c32-9563-996302d4468a': ['Mick Jagger;Keith Richards;Ronnie Wood'],
        };

        let selectedResponses = {};
        let currentResponse = '';
        let musicPlaying = false;
        const backgroundMusic = document.getElementById('backgroundMusic');
        const musicPlayer = document.getElementById('musicPlayer');
        const playIcon = document.getElementById('playIcon');
        const pauseIcon = document.getElementById('pauseIcon');

        // Array de fotos do casal (substitua pelos caminhos reais das suas fotos)
        const couplePhotos = [
            'photo1.jpg', 'photo2.jpg', 'photo3.jpg', 'photo4.jpg', 'photo5.jpg',
            'photo6.jpg', 'photo7.jpg', 'photo8.jpg', 'photo9.jpg', 'photo10.jpg'
        ];

        // --- Fun√ß√£o para Configurar o Rolo de Filme ---
        function setupFilmRoll() {
            const track = document.getElementById('filmRollTrack');
            if (!track) return;
            track.innerHTML = ''; // Limpa o track caso seja chamado novamente

            // Duplica as fotos para o loop cont√≠nuo
            const photosToDisplay = [...couplePhotos, ...couplePhotos];

            photosToDisplay.forEach(photoSrc => {
                const photoDiv = document.createElement('div');
                photoDiv.className = 'film-photo';
                const img = document.createElement('img');
                img.src = photoSrc;
                img.alt = 'Foto do Casal';
                photoDiv.appendChild(img);
                track.appendChild(photoDiv);
            });

            // Opcional: Ajustar a dura√ß√£o da anima√ß√£o baseado no n√∫mero de fotos
            // const photoElementWidth = 100 + 20; // Largura da foto + margens (ajuste se mudar no CSS)
            // const totalWidth = couplePhotos.length * photoElementWidth;
            // const animationDuration = couplePhotos.length * 4; // Ex: 4 segundos por foto
            // track.style.animationDuration = `${animationDuration}s`;
            // track.style.width = `${totalWidth * 2}px`; // Define a largura total do track (2x fotos)

            // Como a anima√ß√£o no CSS j√° usa translateX(-50%), n√£o precisamos definir a largura exata aqui
            // se o n√∫mero de fotos for razoavelmente grande. O browser calcular√°.
        }

        // --- Fun√ß√£o de M√∫sica Atualizada com SVGs ---
        function toggleMusic() {
            if (musicPlaying) {
                backgroundMusic.pause();
                playIcon.style.display = 'block'; // Mostra Play
                pauseIcon.style.display = 'none'; // Esconde Pause
            } else {
                // Tenta tocar a m√∫sica (navegadores podem bloquear autoplay)
                backgroundMusic.play().catch(error => {
                    console.log("Autoplay bloqueado, usu√°rio precisa interagir primeiro.", error);
                    // Poderia mostrar uma mensagem para o usu√°rio clicar novamente
                    return; // N√£o muda o √≠cone se n√£o conseguiu tocar
                });
                playIcon.style.display = 'none'; // Esconde Play
                pauseIcon.style.display = 'block'; // Mostra Pause
            }
            musicPlaying = !musicPlaying;
        }

        // --- Anima√ß√£o do Envelope Atualizada ---
        function startAnimation() {
            const envelopeAnim = document.getElementById('envelopeAnimation');
            const envelopeFlap = document.getElementById('envelopeFlap'); // Usar a flap agora
            const letter = document.getElementById('letter');
            const modal = document.getElementById('inviteModal');
            const modalContent = document.querySelector('.modal-content');
            const originalCard = document.querySelector('.iv-card');

            const cardRect = originalCard.getBoundingClientRect();
            const container = document.querySelector('.envelope-container');

            // Posiciona o container do envelope sobre o card inicial
            container.style.position = 'fixed'; // Usar fixed para sobrepor tudo
            container.style.left = cardRect.left + 'px';
            container.style.top = cardRect.top + 'px';
            container.style.width = cardRect.width + 'px';
            container.style.height = cardRect.height + 'px';

            originalCard.style.opacity = '0'; // Esconde o card original

            envelopeAnim.style.display = 'flex';
            setTimeout(() => {
                envelopeAnim.classList.add('show');

                // Mostra a aba do envelope abrindo
                setTimeout(() => {
                    envelopeFlap.classList.add('show'); // Anima a aba

                    // Inicia anima√ß√£o da carta saindo
                    setTimeout(() => {
                        letter.classList.add('animate');

                        // Quando a carta terminar de expandir, mostra o conte√∫do do modal
                        letter.addEventListener('animationend', () => {
                            modal.style.display = 'flex';
                            setTimeout(() => {
                                modal.classList.add('show');
                                modalContent.classList.add('show');

                                // Inicia o rolo de filme (se ainda n√£o estiver vis√≠vel)
                                document.getElementById('filmRollContainer').style.opacity = 1;
                                document.getElementById('filmRollContainer').style.pointerEvents = 'none'; // Garante que n√£o bloqueie

                            }, 50);

                            // Limpa a anima√ß√£o do envelope ap√≥s um tempo
                            setTimeout(() => {
                                envelopeAnim.classList.remove('show');
                                envelopeFlap.classList.remove('show');
                                letter.classList.remove('animate'); // Remove classe para resetar
                                letter.style.opacity = 0; // Esconde a carta animada
                                originalCard.style.opacity = '1'; // Mostra o card original de novo (opcional)
                                // Reseta posi√ß√£o do container do envelope
                                container.style.position = 'relative';
                                container.style.left = 'auto';
                                container.style.top = 'auto';

                                setTimeout(() => {
                                    envelopeAnim.style.display = 'none';
                                }, 500); // Tempo para fade out
                            }, 500); // Tempo antes de limpar

                        }, { once: true }); // Garante que o listener rode s√≥ uma vez
                    }, 100); // Pequeno delay para a aba come√ßar a abrir antes da carta
                }, 100); // Delay para o fade-in do overlay
            }, 10); // Delay m√≠nimo para iniciar transi√ß√£o
        }

        // --- Fun√ß√£o Thank You (mantida) ---
        function showThankYouImage(response) {
            const thankYouImage = document.getElementById('thankYouImage');
            let imageSrc = '';
            if (response === 'Sim') imageSrc = 'thank-you-yes.png';
            else if (response === 'Talvez') imageSrc = 'thank-you-maybe.png';
            else imageSrc = 'thank-you-no.png';

            if (imageSrc) { // S√≥ mostra se tiver uma imagem definida
                thankYouImage.src = imageSrc;
                thankYouImage.classList.add('show');
                setTimeout(() => {
                    thankYouImage.classList.remove('show');
                }, 30000);
            } else {
                // Se n√£o houver imagem espec√≠fica, talvez mostrar a modal de agradecimento
                showThankYouModal(response);
            }
        }

        // --- L√≥gica de Convidados e Fechamento (mantida em grande parte) ---

        // Fechar modal principal (clicando fora)
        document.getElementById('inviteModal').addEventListener('click', function(e) {
            if (e.target === this) {
                const modal = this;
                const modalContent = modal.querySelector('.modal-content');
                modalContent.classList.remove('show');
                modal.classList.remove('show');
                setTimeout(() => {
                    modal.style.display = 'none';
                }, 500); // Tempo da transi√ß√£o do modal
            }
        });

        function getUUIDFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('uuid');
        }

        function displayGuestInfo(uuid) {
            const guestsString = uuidGuests[uuid]?.[0] || ''; // Pega a string de nomes
            const guestNameElement = document.querySelector('.guest-name');
            const subtitleElements = document.querySelectorAll('.subtitle'); // Pega ambos os subt√≠tulos

            if (!guestsString) {
                guestNameElement.textContent = 'Convidado Especial'; // Nome gen√©rico
                subtitleElements[0].textContent = 'E queremos que voc√™';
                subtitleElements[1].textContent = 'fa√ßa parte dessa celebra√ß√£o';
                return;
            }

            const guestList = guestsString.split(';'); // Divide a string em nomes

            if (guestList.length > 1) {
                // Formata para "Nome1, Nome2 e Nome3"
                const formattedNames = guestList.length > 2
                    ? guestList.slice(0, -1).join(', ') + ' e ' + guestList.slice(-1)
                    : guestList.join(' e '); // Caso de exatamente 2 nomes

                guestNameElement.textContent = formattedNames;
                subtitleElements[0].textContent = 'E queremos que voc√™s'; // Plural
                subtitleElements[1].textContent = 'fa√ßam parte dessa celebra√ß√£o'; // Plural
            } else {
                guestNameElement.textContent = guestList[0]; // Apenas um nome
                subtitleElements[0].textContent = 'E queremos que voc√™'; // Singular
                subtitleElements[1].textContent = 'fa√ßa parte dessa celebra√ß√£o'; // Singular
            }
        }


        function showGuestsDialog(response) {
            currentResponse = response; // Armazena a resposta clicada ('Sim', 'Talvez', 'N√£o')
            const uuid = getUUIDFromURL();
            const guests = uuidGuests[uuid]?.[0]?.split(';') || [];

            // Se for s√≥ 1 convidado ou nenhum, trata direto
            if (guests.length <= 1) {
                const guestName = guests[0] || "Convidado"; // Usa "Convidado" se n√£o houver nome
                handleSingleGuestResponse(guestName, response);
                return; // N√£o abre o dialog
            }

            // Se forem m√∫ltiplos convidados, monta o dialog
            const guestsListElement = document.getElementById('guestsList');
            guestsListElement.innerHTML = guests.map(guest => `
                <div class="guest-item" data-guest="${guest}">
                    <span class="guest-name-label">${guest}</span>
                    <div class="guest-buttons">
                        <button class="response-button" onclick="setGuestResponse(this, '${guest}', 'Sim')">Sim</button>
                        <button class="response-button" onclick="setGuestResponse(this, '${guest}', 'N√£o')">N√£o</button>
                        <button class="response-button" onclick="setGuestResponse(this, '${guest}', 'Talvez')">Talvez</button>
                    </div>
                </div>
            `).join('');

            // Pr√©-seleciona a op√ß√£o clicada para todos inicialmente
            guests.forEach(guest => {
                selectedResponses[guest] = response; // Define a resposta inicial
                const guestItem = guestsListElement.querySelector(`.guest-item[data-guest="${guest}"]`);
                if (guestItem) {
                    const buttons = guestItem.querySelectorAll('.response-button');
                    buttons.forEach(button => {
                        if (button.textContent === response) {
                            button.classList.add('selected');
                        } else {
                            button.classList.remove('selected');
                        }
                    });
                }
            });


            const dialog = document.getElementById('guestsDialog');
            const dialogContent = document.querySelector('.guests-dialog-content');

            dialog.style.display = 'flex';
            setTimeout(() => {
                dialog.classList.add('show');
                setTimeout(() => {
                    dialogContent.classList.add('show');
                }, 50);
            }, 10);
        }

        // Atualiza setGuestResponse para receber o elemento bot√£o clicado
        function setGuestResponse(buttonElement, guest, response) {
            selectedResponses[guest] = response;

            // Remove 'selected' de outros bot√µes no mesmo grupo e adiciona ao clicado
            const buttonGroup = buttonElement.parentElement;
            buttonGroup.querySelectorAll('.response-button').forEach(button => {
                button.classList.remove('selected');
            });
            buttonElement.classList.add('selected');
        }


        function closeGuestsDialog() {
            const dialog = document.getElementById('guestsDialog');
            const dialogContent = document.querySelector('.guests-dialog-content');

            dialogContent.classList.remove('show');
            dialog.classList.remove('show');

            setTimeout(() => {
                dialog.style.display = 'none';
                selectedResponses = {}; // Limpa as respostas ao fechar
            }, 300);
        }

        function confirmAllResponses() {
            const uuid = getUUIDFromURL();
            // As respostas j√° foram atualizadas individualmente ou pr√©-definidas no showGuestsDialog
            // Apenas verifica se todos t√™m uma resposta (se necess√°rio, ou assume a inicial)
            const guests = uuidGuests[uuid]?.[0]?.split(';') || [];
            guests.forEach(guest => {
                if (!selectedResponses[guest]) {
                    // Se algum convidado ficou sem resposta marcada (improv√°vel com a pr√©-sele√ß√£o),
                    // atribui a resposta original clicada ('currentResponse')
                    selectedResponses[guest] = currentResponse;
                }
            });


            const report = generateReport(uuid, selectedResponses);
            sendToTelegram(report);
            // Mostra a imagem de agradecimento correspondente √† *resposta inicial clicada*
            showThankYouImage(currentResponse);
            closeGuestsDialog();
            // Fecha o modal principal tamb√©m
            closeModal();
        }


        function handleSingleGuestResponse(guest, response) {
            const uuid = getUUIDFromURL();
            const report = generateReport(uuid, { [guest]: response });
            sendToTelegram(report);
            // Mostra a imagem de agradecimento
            showThankYouImage(response);
            // Fecha o modal principal
            closeModal();
        }

        function closeModal() {
            const modal = document.getElementById('inviteModal');
            const modalContent = modal.querySelector('.modal-content');
            if (modal.style.display !== 'none') {
                modalContent.classList.remove('show');
                modal.classList.remove('show');
                setTimeout(() => {
                    modal.style.display = 'none';
                }, 500); // Tempo da transi√ß√£o
            }
        }


        function generateReport(uuid, responses) {
            const timestamp = new Date().toLocaleString('pt-BR', { timeZone: 'America/Sao_Paulo' });
            let report = `<b>üéâ Novo RSVP Recebido! üéâ</b>\n\n`;
            report += `<b>üìÖ Data/Hora:</b> ${timestamp}\n`;
            // report += `üîë UUID: ${uuid}\n\n`; // UUID pode n√£o ser necess√°rio no report final
            report += `<b>üë§ Convidado(s):</b>\n`;

            Object.entries(responses).forEach(([guest, response]) => {
                const emoji = response === 'Sim' ? '‚úÖ' : response === 'Talvez' ? '‚ùì' : '‚ùå';
                report += `${emoji} ${guest}: <b>${response}</b>\n`;
            });

            return report;
        }


        async function sendToTelegram(message) {
            console.log("Enviando para Telegram:", message); // Log para debug
            try {
                const response = await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json', },
                    body: JSON.stringify({
                        chat_id: TELEGRAM_CHANNEL_ID,
                        text: message,
                        parse_mode: 'HTML' // Usar HTML para negrito etc.
                    })
                });
                const data = await response.json(); // Pega a resposta da API
                if (!response.ok) {
                    console.error('Erro ao enviar mensagem para o Telegram:', data);
                } else {
                    console.log('Mensagem enviada com sucesso:', data);
                }
            } catch (error) {
                console.error('Erro na requisi√ß√£o para o Telegram:', error);
            }
        }

        // Fun√ß√£o showThankYouModal (mantida, chamada se n√£o houver showThankYouImage)
        function showThankYouModal(response) {
            const modalInner = document.querySelector('.modal-inner');
            let message = '';
            let title = "Obrigado pelo Retorno!";

            switch(response) {
                case 'Sim':
                    message = 'Mal podemos esperar para celebrar com voc√™! Mais detalhes ser√£o enviados em breve. ü•≥';
                    break;
                case 'Talvez':
                    message = 'Entendido! Aguardamos sua confirma√ß√£o final quando puder. üòä';
                    break;
                case 'N√£o':
                    message = 'Que pena que n√£o poder√° comparecer. Sentiremos sua falta! Agradecemos por avisar. ‚ù§Ô∏è';
                    break;
                default:
                    title = "Resposta Registrada!"
                    message = "Sua resposta foi registrada com sucesso."
            }

            // Substitui o conte√∫do do modal pelo agradecimento
            modalInner.innerHTML = `
                <div class="thank-you-modal">
                    <h2 class="thank-you-title">${title}</h2>
                    <p class="thank-you-message">${message}</p>
                    <button class="back-button" style="margin-top: 20px; background-color: var(--accent-color);" onclick="closeModal()">Fechar</button>
                </div>
            `;

            // Garante que o modal est√° vis√≠vel se j√° n√£o estiver
            const modal = document.getElementById('inviteModal');
            const modalContent = modal.querySelector('.modal-content');
            if(modal.style.display === 'none') {
                modal.style.display = 'flex';
                setTimeout(() => {
                    modal.classList.add('show');
                    modalContent.classList.add('show');
                }, 50)
            }
        }


        // Adiciona listeners aos bot√µes usando data attribute
        document.querySelectorAll('.circular-button').forEach(button => {
            button.addEventListener('click', () => {
                const response = button.getAttribute('data-response'); // Pega 'Sim', 'Talvez' ou 'N√£o'
                showGuestsDialog(response);
            });
        });

        // --- Inicializa√ß√£o ---
        document.addEventListener('DOMContentLoaded', () => {
            const uuid = getUUIDFromURL();
            if (uuid) {
                displayGuestInfo(uuid);
            } else {
                displayGuestInfo(null); // Mostra nome gen√©rico se n√£o houver UUID
            }

            setupFilmRoll(); // Configura o rolo de filme ao carregar a p√°gina

            // Inicia m√∫sica em volume baixo e tenta autoplay
            backgroundMusic.volume = 0.3;
            
            // Tenta iniciar a m√∫sica automaticamente
            backgroundMusic.play().then(() => {
                // Se conseguir tocar, atualiza interface
                musicPlaying = true;
                playIcon.style.display = 'none';
                pauseIcon.style.display = 'block';
            }).catch(error => {
                // Se for bloqueado (comportamento esperado), mant√©m o √≠cone de play
                console.log("Autoplay bloqueado pelo navegador. O usu√°rio precisa interagir primeiro.", error);
                musicPlaying = false;
                playIcon.style.display = 'block';
                pauseIcon.style.display = 'none';
            });
        });
    </script>
    <script src="app.js?v=1.0.1"></script>
</body>
</html>
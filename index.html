<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>#SaveTheDate 16 Agosto 2025</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: url('bg.jpeg') center/cover no-repeat;
        }

        .container {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .tv-save {
            width: 299px;
            height: 72px;
            margin-bottom: 16px;
        }

        .iv-card {
            width: 260px;
            height: 260px;
            animation: pulse 1.5s infinite;
            cursor: pointer;
        }

        .iv-leaves {
            width: 166px;
            height: 166px;
            margin: 16px;
        }

        .tv-subtitle {
            width: 313px;
            height: 40px;
            margin-top: 16px;
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                opacity: 1;
            }
            50% {
                transform: scale(1.1);
                opacity: 0.8;
            }
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
            z-index: 1000;
            padding: 48px 24px;
            box-sizing: border-box;
        }

        .modal-content {
            background: white;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            border: 6px solid #F4CB7B;
            border-radius: 200px 200px 0 0;
            margin: 0 auto;
        }

        .modal-inner {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 96px 24px 64px 24px;
        }

        .title {
            color: #3D7600;
            font-weight: bold;
            font-size: 24px;
            margin-bottom: 16px;
            text-align: center;
        }

        .subtitle {
            color: black;
            font-size: 20px;
            margin: 16px 0;
        }

        .guest-name {
            color: #3D7600;
            font-weight: bold;
            font-size: 32px;
            margin: 16px 0;
        }

        .date-image {
            width: 277px;
            height: 152px;
            margin: 24px 0;
        }

        .confirm-title {
            width: 214px;
            height: 32px;
            margin: 16px 0;
        }

        .confirm-text {
            font-size: 14px;
            color: black;
            margin: 8px 24px;
        }

        .buttons-container {
            display: flex;
            justify-content: space-between;
            margin-top: 16px;
            gap: 16px;
            padding: 0 24px;
        }

        .button-group {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }

        .circular-button {
            width: 80px;
            height: 80px;
            border: 0.6px solid #3D7600;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            background: white;
            padding: 16px;
            margin-bottom: 8px;
            transition: background 0.3s, color 0.3s;
        }

        .circular-button.active {
            background-color: #3D7600;
            color: white;
        }

        .circular-button:hover {
            background-color: #2B5400;
        }

        .button-text {
            font-size: 12px;
            color: black;
            text-align: center;
            margin-top: 8px;
        }

        .leaf1 {
            position: absolute;
            top: -20px;
            left: -20px;
            width: 206px;
            height: 202px;
            pointer-events: none;
        }

        .leaf2 {
            position: absolute;
            bottom: -20px;
            right: -20px;
            width: 217px;
            height: 116px;
            pointer-events: none;
        }

        /* Ajustes para mobile */
        @media (max-width: 768px) {
            .modal {
                padding: 24px 12px;
            }

            .buttons-container {
                flex-direction: column;
                gap: 24px;
            }

            .modal-content {
                border-radius: 100px 100px 0 0;
            }

            .leaf1, .leaf2 {
                width: 150px;
                height: auto;
            }
        }

        .envelope-animation {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 999;
            background: rgba(0, 0, 0, 0.5);
        }

        .envelope-container {
            position: relative;
            width: 260px;
            height: 260px;
        }

        .envelope-open {
            width: 100%;
            height: 100%;
            position: absolute;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .envelope-open.show {
            opacity: 1;
        }

        .letter {
            position: absolute;
            background: white;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 200px;
            height: 10px;
            opacity: 0;
        }

        .letter.animate {
            animation: expandLetter 1s forwards;
        }

        @keyframes expandLetter {
            0% {
                width: 200px;
                height: 10px;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                opacity: 1;
            }
            30% {
                width: 200px;
                height: 200px;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                opacity: 1;
            }
            100% {
                width: 90vw;
                max-width: 600px;
                height: 90vh;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                opacity: 1;
            }
        }

        .modal {
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s;
        }

        .modal.show {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            opacity: 0;
            transition: opacity 0.3s;
        }

        .modal-content.show {
            opacity: 1;
        }

        .modal-multiple {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }

        .modal-content-multiple {
            background: white;
            padding: 24px;
            border-radius: 10px;
            max-width: 500px;
            width: 90%;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
        }

        .guest-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .guest-list li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .button {
            border: 2px solid;
            border-radius: 5px;
            padding: 10px 20px;
            cursor: pointer;
            margin: 5px;
            font-size: 16px;
        }

        .button-green {
            border-color: green;
            color: green;
            background: white;
        }

        .button-red {
            border-color: red;
            color: red;
            background: white;
        }

        .final-modal {
            display: none;
        }

        .guests-dialog {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            z-index: 2000;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .guests-dialog-content {
            background: white;
            border-radius: 12px;
            padding: 24px;
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .guest-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }

        .guest-name-label {
            font-size: 16px;
            color: #333;
        }

        .guest-buttons {
            display: flex;
            gap: 8px;
        }

        .response-button {
            padding: 8px 16px;
            border: 2px solid #3D7600;
            border-radius: 6px;
            background: white;
            color: #3D7600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .response-button:hover {
            background: #3D7600;
            color: white;
        }

        .response-button.selected {
            background: #3D7600;
            color: white;
        }

        .dialog-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 24px;
            gap: 12px;
        }

        .confirm-all-button {
            padding: 12px 24px;
            border: 2px solid #3D7600;
            background: white;
            color: #3D7600;
            border-radius: 6px;
            cursor: pointer;
            flex: 1;
        }

        .back-button {
            padding: 12px 24px;
            border: 2px solid #FF4444;
            background: white;
            color: #FF4444;
            border-radius: 6px;
            cursor: pointer;
            flex: 1;
        }

        /* Estilos para o modal de agradecimento */
        .thank-you-modal {
            text-align: center;
            padding: 48px 24px;
        }

        .thank-you-title {
            color: #3D7600;
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 24px;
        }

        .thank-you-message {
            color: #333;
            font-size: 18px;
            line-height: 1.5;
            max-width: 400px;
            margin: 0 auto;
        }
    </style>
</head>
<body>
    <div class="container">
        <img class="tv-save" src="tv_save_the_date.png" alt="Save the Date">
        <img class="iv-card" src="iv_card.png" alt="Card" onclick="startAnimation()">
        <img class="tv-subtitle" src="tv_subtitle.png" alt="Subtitle">
    </div>

    <div class="envelope-animation" id="envelopeAnimation">
        <div class="envelope-container">
            <img class="envelope-open" id="envelopeOpen" src="envelope_open.png" alt="Envelope Aberto">
            <div class="letter" id="letter"></div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal" id="inviteModal">
        <div class="modal-content">
            <img class="leaf1" src="iv_leaf1.png" alt="Leaf 1">
            
            <div class="modal-inner">
                <h1 class="title">Elian e Keytiane<br>estão se casando!</h1>
                <p class="subtitle">E queremos que você</p>
                <p class="guest-name">Nome Convidado</p>
                <p class="subtitle">faça parte dessa celebração</p>
                
                <img class="date-image" src="iv_date.png" alt="Data">
                <img class="confirm-title" src="tv_confirm_title.png" alt="Confirme sua presença">
                
                <p class="confirm-text">
                    Por favor, nos informe abaixo se você poderá se juntar a nós nesse dia especial.
                </p>

                <div class="buttons-container">
                    <div class="button-group">
                        <button class="circular-button">
                            <img src="btn_yes.png" alt="Sim" width="48" height="48">
                        </button>
                        <span class="button-text">Sim, eu posso comparecer!</span>
                    </div>

                    <div class="button-group">
                        <button class="circular-button">
                            <img src="btn_maybe.png" alt="Talvez" width="48" height="48">
                        </button>
                        <span class="button-text">Preciso de um tempo para confirmar</span>
                    </div>

                    <div class="button-group">
                        <button class="circular-button">
                            <img src="btn_no.png" alt="Não" width="48" height="48">
                        </button>
                        <span class="button-text">Infelizmente não posso comparecer</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="guests-dialog" id="guestsDialog">
        <div class="guests-dialog-content">
            <h2>Confirme a presença</h2>
            <div id="guestsList">
                <!-- Preenchido dinamicamente -->
            </div>
            <div class="dialog-actions">
                <button class="confirm-all-button" onclick="confirmAllResponses()">
                    Confirmar Opção para Todos
                </button>
                <button class="back-button" onclick="closeGuestsDialog()">
                    Voltar
                </button>
            </div>
        </div>
    </div>

    <script>
        const TELEGRAM_BOT_TOKEN = '7790968479:AAFWGQcuxa2sy95191i0IjNAFAZNDspDLXI';
        const TELEGRAM_CHANNEL_ID = '-1002378516159';

        let selectedResponses = {};
        let currentResponse = '';

        function startAnimation() {
            const envelopeAnim = document.getElementById('envelopeAnimation');
            const envelopeOpen = document.getElementById('envelopeOpen');
            const letter = document.getElementById('letter');
            const modal = document.getElementById('inviteModal');
            const modalContent = document.querySelector('.modal-content');
            const originalCard = document.querySelector('.iv-card');
            
            // Pega a posição do cartão original
            const cardRect = originalCard.getBoundingClientRect();
            
            // Posiciona o envelope na mesma posição do cartão
            const container = document.querySelector('.envelope-container');
            container.style.position = 'absolute';
            container.style.left = cardRect.left + 'px';
            container.style.top = cardRect.top + 'px';
            
            // Inicia a sequência de animação
            envelopeAnim.style.display = 'flex';
            
            // Mostra o envelope aberto
            setTimeout(() => {
                envelopeOpen.classList.add('show');
                
                // Inicia animação da carta
                setTimeout(() => {
                    letter.classList.add('animate');
                    
                    // Quando a carta terminar de expandir, mostra o conteúdo do modal
                    setTimeout(() => {
                        modal.style.display = 'flex';
                        modalContent.classList.add('show');
                        modal.classList.add('show');
                        
                        // Limpa a animação
                        setTimeout(() => {
                            envelopeAnim.style.display = 'none';
                            letter.classList.remove('animate');
                            envelopeOpen.classList.remove('show');
                        }, 300);
                    }, 1000);
                }, 300);
            }, 100);
        }

        // Fechar modal
        document.getElementById('inviteModal').addEventListener('click', function(e) {
            if (e.target === this) {
                const modal = this;
                const modalContent = modal.querySelector('.modal-content');
                
                modalContent.classList.remove('show');
                modal.classList.remove('show');
                
                setTimeout(() => {
                    modal.style.display = 'none';
                }, 300);
            }
        });

        const uuidGuests = {
            '3432420a-d313-499c-97e7-a7c8c8030bba': ['Keytiane Ferreira'],
            '3432420a-d313-499c-97e7-a7c8c8030bbc': ['Iolanda;Lorenna'],
            'ef0585ca-3ce9-4d28-8b88-bb7d5d04c07b': ['Mª de Fátima Costa'],
            'fd419500-bb85-4393-af9c-a1d68953acd5': ['Marlene Costa'],
            '107277af-3865-4762-8259-011ad560a0fd': ['Mª Madalena Souza'],
            'e92f6978-f579-42e2-9e97-6f93adb68833': ['Miguel;Aldenice Souza'],
            'd3dd2c8a-ec19-46ce-ac5f-d9455ce5ffa6': ['Michel;Izandra Souza'],
            '3dd17089-0d14-479c-a3b7-83e48b6e04e6': ['Jefferson;Clarinda Souza'],
            'cc7745c8-bba9-49fd-a7a9-f39e5d19dbe4': ['Wanda;Ocimar Souza'],
            '11f8a596-3529-4607-97c5-4e016c16d5b0': ['Vera;Cássia;Eva Souza'],
            'ba0a5d08-005f-4e24-90d1-09bc11395100': ['Magdiel Souza'],
            '8cc3b813-b735-44c9-a139-309c1c33098a': ['Hudson Souza'],
            '686973ed-dfd9-4025-b4e2-16d8cdafb860': ['Elias Souza'],
            '6c14159d-b904-43d7-b1e0-e33005d4d514': ['Lázaro Souza'],
            '99c3880d-ffd7-4837-bb19-fc40f03fc6f9': ['João Batista Brito'],
            'be932394-a101-4640-9294-4b1f7f3c7e0b': ['Manoel;Iolane Rendeiro'],
            'c2936ad3-19ac-441c-b39b-ba6a8fdb126e': ['Rosilda Oliveira'],
            '763e706d-55c6-4271-b853-46bc50fa82ab': ['Socorro;Ronaldo Gomes'],
            '3ef483a3-1cdb-431c-b13c-663e347c3ba7': ['Maitê;Nicolas'],
            '0c459e63-c90d-4ed2-b01b-6b4f8ebf0be9': ['Dom Giuliano'],
            '29181420-098f-4bab-ad41-c8392b8f1d59': ['Alcione Praia'],
            '38773c5d-e9d3-41c4-9248-0dd0300402d0': ['Elian Monteiro'],
            '9eccb9cf-2237-4f71-a4e3-1b2002c7baf9': ['Even Neves'],
            '6d93f247-a283-4fb9-91eb-96a385d99470': ['Ellis;Cecília;Benjamin'],
            '6a3e5dca-f4fe-4e05-98c5-10d5629b0e80': ['Rommel Souza'],
            'f995f996-9667-4167-878a-9ae68a959a24': ['André Luís'],
            '6b103e10-e49c-4c55-883a-c47713afe6ac': ['Jussara Itou'],
            '126eba38-4c01-42e2-acce-f229b3149669': ['Marcos Itou'],
            'c82e5799-b3fe-4b50-bbd6-48c66ef8bf00': ['David Lazaroni'],
            '14fc32ee-be33-4600-b1b0-27b3d5018dbb': ['Dayell Souza'],
            'a3e674b6-08ae-4031-a562-341e7e410080': ['Thiago Ferreira'],
            '2adb38ae-332b-4d10-9936-2772e2d7487e': ['Jonathas Modesto'],
            'e8acb29f-348b-46d5-806d-72bfdbee9559': ['Amélia Emmely;Lívia Medeiros'],
            '658d2323-d379-47c4-9bc9-2d653ecebb19': ['Manoel Roberto;Luciene Medeiros'],
            '83d20876-0eac-43aa-a7ce-ee1473266c35': ['Gilcllys Costa'],
            'e364a165-0a84-421b-b70e-dd3a7eb9614d': ['Jeana Samara'],
            '9c8503c3-a742-4c41-8746-1ca09e160786': ['Amanda Araújo'],
            '5c82f9e3-9def-49f0-9780-14d3c7a6f536': ['Júlia Kauane'],
            '952a25ea-cb8f-4c43-b628-6a298fa2faf5': ['Christine Lima'],
            'c7de1790-2b4e-4208-aa8c-659793faa76c': ['Karol;Williames;Ana Garcia'],
            'cd65f209-a3da-42f1-a5d1-2d45c6221791': ['Jenifer Garcia'],
            '272363d9-5ebc-4237-a23c-7fbd3cecdb69': ['Silvia Cristina'],
            '0cdcdbd4-b16d-4faf-b536-e0050e3ba928': ['Ana Rita Maciel'],
            '8da5a733-26fe-407c-bdee-cab0802486b5': ['Daniel'],
            '25965a02-db2e-4aeb-a5e8-c83830a06c29': ['Rosivaldo'],
            '4876069a-62d2-497b-873f-7b0fc0c0340d': ['Raimunda Maciel'],
            '10d8dca4-0bdf-4651-90fb-cbca248d1257': ['Mª de Nazaré'],
            '0be5e1a8-341f-4f82-8be7-ae9367cf5b01': ['João Luís'],
            '359fe25f-c9a5-40b6-aff8-23a22ad6669f': ['Alexandre Rocha'],
            '08c7e445-d472-47e0-a700-9867e2e57079': ['Gabriel Rocha'],
            'ff71de1e-f795-4bc6-baf9-2215f1d768f2': ['João Vitor'],
            '64623d93-2882-4b24-9460-f8ca06e4ab00': ['Keyla Vitória'],
            '2d8e5fc4-8802-453c-863e-ff0c474e10fb': ['Elaine Rocha'],
            'c2cf60c1-708c-43ff-881d-22792a8b64a8': ['Renner Cid'],
            '6962309e-4653-4b2c-a834-ba005ee12f22': ['Érico Márcio'],
            'f1dc4310-e131-4e1d-a03f-3a761c0f8df7': ['Eder Marcelo'],
            'd2a792d7-6abd-4030-a11a-8bec05c52d4d': ['Larissa Costa'],
            '5aa38407-4ab2-48f5-bb70-1d7101d0cf0d': ['Neuzyane Batista'],
            'c9f65cb9-475b-487e-910c-1b54c7e8c16a': ['Pablo'],
            '1e8d1eab-7f23-4ceb-83ca-283dc34ba008': ['Iolene Garcia'],
            '94da4a05-34bf-4727-9848-eae70a0b344f': ['Eloá'],
            'f30e3615-ab91-4f25-a67e-5783b1b39259': ['Tio Zé'],
            '3d2eceb2-2563-48c0-adb7-c550ddd6cacb': ['Ana;Eliseu'],
            '11b7bbe0-477d-4ac1-880a-16f22ee92e7f': ['Isabele'],
            'b3d1ba9d-f9e7-4c48-8dd5-95831a4eba95': ['Kylcia Brilhante'],
            'c72ab227-4fa5-464f-bb17-58483cdd5410': ['Kyldare;Silvia Brilhante'],
            '845d5dd1-320e-42db-b320-5a4b67917a25': ['Adinamar Klinge'],
            '4c068e8a-264c-4ea0-9222-882d88f71c33': ['Samia;Marido Samia'],
            '373ca430-3231-4d1b-9ade-0f58ed135bad': ['Mª da Conceição'],
            '96d22881-8d37-4906-bdab-0a75ca8c164a': ['Kely'],
            '47f51b22-0ac1-4fe4-9433-b414dbfcff5d': ['Louro'],
            'c93acc7c-ae49-4022-af9b-d0b654e4ca32': ['Paloma'],
            'd187762a-c81b-4382-ae08-54b7a16e7e5a': ['Sandro'],
            '9011c0da-07be-4d58-8356-2c26a0b3166d': ['Paula Mércia'],
            '8c6e4468-481c-40b6-ab5a-3a0f40ab7fec': ['Maria Clara'],
            '13e7098d-890e-49ae-baeb-cbac59e28d54': ['Paulo André'],
            'd66f392a-1019-4cc9-a7dd-dddb9475b37f': ['Carlos Eduardo'],
            '4fff8a0f-db03-4be5-aa83-f94d2cc0d157': ['Paul McCartney'],
            '25f8cd16-ba08-4c32-9563-996302d4468a': ['Mick Jagger;Keith Richards;Ronnie Wood'],
        };

        function getUUIDFromURL() {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get('uuid');
        }

        function displayGuestInfo(uuid) {
            const guests = uuidGuests[uuid]?.[0] || ''; // Obtém a lista de nomes do UUID
            const guestNameElement = document.querySelector('.guest-name');
            const subtitleElements = document.querySelectorAll('.subtitle');

            if (!guests) {
                guestNameElement.textContent = 'Convidado desconhecido';
                subtitleElements[0].textContent = 'E queremos que você';
                subtitleElements[1].textContent = 'faça parte dessa celebração';
                return;
            }

            // Analisa se há mais de um convidado
            if (guests.includes(';')) {
                const guestList = guests.split(';');
                const formattedNames = guestList
                    .slice(0, -1) // Todos menos o último
                    .join(', ') // Adiciona ", " entre os primeiros
                    .concat(' e ', guestList.slice(-1)); // Adiciona " e " antes do último

                guestNameElement.textContent = formattedNames;

                subtitleElements[0].textContent = 'E queremos que vocês';
                subtitleElements[1].textContent = 'façam parte dessa celebração';
            } else {
                guestNameElement.textContent = guests;
                subtitleElements[0].textContent = 'E queremos que você';
                subtitleElements[1].textContent = 'faça parte dessa celebração';
            }
        }

        function showMultipleGuestsModal(guests) {
            const modal = document.getElementById('multipleGuestsModal');
            const guestList = document.getElementById('guestList');

            guestList.innerHTML = '';
            guests.forEach(guest => {
                const li = document.createElement('li');
                li.innerHTML = `${guest}
                    <button onclick="logResponse('${guest}', 'Sim')">Sim</button>
                    <button onclick="logResponse('${guest}', 'Talvez')">Talvez</button>
                    <button onclick="logResponse('${guest}', 'Não')">Não</button>`;
                guestList.appendChild(li);
            });

            modal.style.display = 'flex';
        }

        function confirmAllGuests(response) {
            const uuid = getUUIDFromURL();
            const guests = uuidGuests[uuid] || [];

            guests.forEach(guest => {
                logResponse(guest, response);
            });

            closeMultipleGuestsModal();
        }

        function closeMultipleGuestsModal() {
            const modal = document.getElementById('multipleGuestsModal');
            modal.style.display = 'none';
        }

        function logResponse(guest, response) {
            const uuid = getUUIDFromURL();
            console.log(`Convidado: ${guest}, UUID: ${uuid}, Resposta: ${response}`);
        }

        document.addEventListener('DOMContentLoaded', () => {
            const uuid = getUUIDFromURL();
            if (uuid) {
                displayGuestInfo(uuid);
            }
        });

        function showGuestsDialog(response) {
            currentResponse = response;
            const uuid = getUUIDFromURL();
            const guests = uuidGuests[uuid]?.[0]?.split(';') || [];
            
            if (guests.length <= 1) {
                handleSingleGuestResponse(guests[0], response);
                return;
            }

            const guestsListElement = document.getElementById('guestsList');
            guestsListElement.innerHTML = guests.map(guest => `
                <div class="guest-item">
                    <span class="guest-name-label">${guest}</span>
                    <div class="guest-buttons">
                        <button class="response-button" onclick="setGuestResponse('${guest}', 'Sim')">Sim</button>
                        <button class="response-button" onclick="setGuestResponse('${guest}', 'Talvez')">Talvez</button>
                        <button class="response-button" onclick="setGuestResponse('${guest}', 'Não')">Não</button>
                    </div>
                </div>
            `).join('');

            document.getElementById('guestsDialog').style.display = 'flex';
        }

        function setGuestResponse(guest, response) {
            selectedResponses[guest] = response;
            
            // Atualiza visual dos botões
            const guestItem = document.querySelector(`[onclick="setGuestResponse('${guest}', '${response}')"]`).parentElement;
            guestItem.querySelectorAll('.response-button').forEach(button => {
                button.classList.remove('selected');
                if (button.textContent === response) {
                    button.classList.add('selected');
                }
            });
        }

        function confirmAllResponses() {
            const uuid = getUUIDFromURL();
            const guests = uuidGuests[uuid]?.[0]?.split(';') || [];
            
            // Se algum convidado não teve resposta definida, usa a resposta atual
            guests.forEach(guest => {
                if (!selectedResponses[guest]) {
                    selectedResponses[guest] = currentResponse;
                }
            });

            // Gera o log report
            const report = generateReport(uuid, selectedResponses);
            
            // Envia para o Telegram
            sendToTelegram(report);

            // Mostra modal de agradecimento
            showThankYouModal(currentResponse);
            
            closeGuestsDialog();
        }

        function handleSingleGuestResponse(guest, response) {
            const uuid = getUUIDFromURL();
            const report = generateReport(uuid, { [guest]: response });
            
            sendToTelegram(report);
            showThankYouModal(response);
        }

        function generateReport(uuid, responses) {
            const timestamp = new Date().toLocaleString('pt-BR');
            let report = `🎉 Novo RSVP recebido!\n\n`;
            report += `📅 Data: ${timestamp}\n`;
            report += `🔑 UUID: ${uuid}\n\n`;
            
            Object.entries(responses).forEach(([guest, response]) => {
                const emoji = response === 'Sim' ? '✅' : response === 'Talvez' ? '❓' : '❌';
                report += `${emoji} ${guest}: ${response}\n`;
            });
            
            return report;
        }

        async function sendToTelegram(message) {
            try {
                const response = await fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        chat_id: TELEGRAM_CHANNEL_ID,
                        text: message,
                        parse_mode: 'HTML'
                    })
                });
                
                if (!response.ok) {
                    console.error('Erro ao enviar mensagem para o Telegram');
                }
            } catch (error) {
                console.error('Erro na requisição:', error);
            }
        }

        function showThankYouModal(response) {
            const modalInner = document.querySelector('.modal-inner');
            let message = '';
            
            switch(response) {
                case 'Sim':
                    message = 'Estamos ansiosos para celebrar com você. Enviaremos mais detalhes em breve.';
                    break;
                case 'Talvez':
                    message = 'Aguardamos ansiosamente sua confirmação ou atualização sobre sua disponibilidade.';
                    break;
                case 'Não':
                    message = 'Obrigado por nos informar. Não há problema, esperamos que você esteja bem e que possamos nos encontrar em breve.';
                    break;
            }

            modalInner.innerHTML = `
                <div class="thank-you-modal">
                    <h2 class="thank-you-title">Obrigado pelo Retorno!</h2>
                    <p class="thank-you-message">${message}</p>
                </div>
            `;
        }

        function closeGuestsDialog() {
            document.getElementById('guestsDialog').style.display = 'none';
            selectedResponses = {};
        }

        document.querySelectorAll('.circular-button').forEach((button, index) => {
            button.addEventListener('click', () => {
                const responses = ['Sim', 'Talvez', 'Não'];
                showGuestsDialog(responses[index]);
            });
        });
    </script>
</body>
</html>